---
import type { GetStaticPaths } from "astro";
// import NavigationHeader from "../../components/NavigationHeader.astro";
import ProductMain from "../../components/product/ProductMain.astro";
import ProductDetails from "../../components/ProductDetails.astro";
import ProductReviews from "../../components/product/ProductReviews.astro";
import SecondaryNavigation from "../../components/SecondaryNavigation.astro";
import { fetchFromStripe } from "../../api/stripe";
import Layout from "../../layouts/Layout.astro";

interface Product {
    name: string;
    metadata: {
        slug: string;
    };
}


export const getStaticPaths = (async () => {
    const productsResponse = await fetchFromStripe("/products");

    console.debug("productsResponse", productsResponse);

    return productsResponse.data.map((product: any) => ({
        params: { slug: product.metadata.slug },
        props: { product },
    }));
}) satisfies GetStaticPaths;

const { product } = Astro.props as { product: Product };
---

<Layout title={product.name + " | Antonito's Pepper Company"}>
    <ProductMain product={product} />

    <ProductDetails product={product} />

    <ProductReviews product={product} />
</Layout>
